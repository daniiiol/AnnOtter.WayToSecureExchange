<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1017px" preserveAspectRatio="none" style="width:838px;height:1017px;background:#F9F9F9;" version="1.1" viewBox="0 0 838 1017" width="838px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="27.6094" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="146" x="347" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="352" y="29.5332">Encryption Process</text><rect fill="#AABACF" height="741.6875" style="stroke:#393939;stroke-width:1.0;" width="10" x="244" y="149.7969"/><rect fill="#AABACF" height="535.1328" style="stroke:#393939;stroke-width:1.0;" width="10" x="490" y="375.3516"/><rect fill="#AABACF" height="409.8906" style="stroke:#393939;stroke-width:1.0;" width="10" x="650" y="500.5938"/><rect fill="#F4F2EE" height="196.0703" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="487" x="344" y="390.3516"/><path d="M344,527.9453 L831,527.9453 L831,582.9219 A3.5,3.5 0 0 1 827.5,586.4219 L347.5,586.4219 A3.5,3.5 0 0 1 344,582.9219 L344,527.9453 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><rect fill="#F4F2EE" height="141.3047" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="369" x="10" y="743.1797"/><path d="M10,842.0703 L379,842.0703 L379,880.9844 A3.5,3.5 0 0 1 375.5,884.4844 L13.5,884.4844 A3.5,3.5 0 0 1 10,880.9844 L10,842.0703 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="121.2188" y2="919.4844"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="249" x2="249" y1="121.2188" y2="919.4844"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="494.5" x2="494.5" y1="121.2188" y2="919.4844"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="654.5" x2="654.5" y1="121.2188" y2="919.4844"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="118.1426">Alice</text><ellipse cx="38" cy="52.1094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,60.1094 L38,87.1094 M25,68.1094 L51,68.1094 M38,87.1094 L25,102.1094 M38,87.1094 L51,102.1094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="933.0176">Alice</text><ellipse cx="38" cy="944.5938" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,952.5938 L38,979.5938 M25,960.5938 L51,960.5938 M38,979.5938 L25,994.5938 M38,979.5938 L51,994.5938 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="213" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="220" y="110.1426">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="213" y="918.4844"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="220" y="940.0176">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="460.5" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="467.5" y="110.1426">Backend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="460.5" y="918.4844"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="467.5" y="940.0176">Backend</text><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="621.5" y="118.1426">Database</text><path d="M637,67.6094 C637,57.6094 655,57.6094 655,57.6094 C655,57.6094 673,57.6094 673,67.6094 L673,93.6094 C673,103.6094 655,103.6094 655,103.6094 C655,103.6094 637,103.6094 637,93.6094 L637,67.6094 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M637,67.6094 C637,77.6094 655,77.6094 655,77.6094 C655,77.6094 673,77.6094 673,67.6094 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="621.5" y="933.0176">Database</text><path d="M637,946.0938 C637,936.0938 655,936.0938 655,936.0938 C655,936.0938 673,936.0938 673,946.0938 L673,972.0938 C673,982.0938 655,982.0938 655,982.0938 C655,982.0938 637,982.0938 637,972.0938 L637,946.0938 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M637,946.0938 C637,956.0938 655,956.0938 655,956.0938 C655,956.0938 673,956.0938 673,946.0938 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><rect fill="#AABACF" height="741.6875" style="stroke:#393939;stroke-width:1.0;" width="10" x="244" y="149.7969"/><rect fill="#AABACF" height="535.1328" style="stroke:#393939;stroke-width:1.0;" width="10" x="490" y="375.3516"/><rect fill="#AABACF" height="409.8906" style="stroke:#393939;stroke-width:1.0;" width="10" x="650" y="500.5938"/><polygon fill="#CD5764" points="232,145.7969,242,149.7969,232,153.7969,236,149.7969" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="149.7969" y2="149.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="106" x="45" y="145.5996">Start to create a secret</text><polygon fill="#CD5764" points="49,172.375,39,176.375,49,180.375,45,176.375" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="176.375" y2="176.375"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="124" x="55" y="172.1777">Receive initial application</text><polygon fill="#CD5764" points="232,198.9531,242,202.9531,232,206.9531,236,202.9531" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="202.9531" y2="202.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="76" x="45" y="198.7559">Enter secret text</text><polygon fill="#CD5764" points="232,225.5313,242,229.5313,232,233.5313,236,229.5313" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="229.5313" y2="229.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="68" x="45" y="225.334">Click generate</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="268.9609" y2="268.9609"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="268.9609" y2="281.9609"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="281.9609" y2="281.9609"/><polygon fill="#CD5764" points="265,277.9609,255,281.9609,265,285.9609,261,281.9609" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="147" x="261" y="264.7637">Generate a PBKDF2 DeriveKey</text><path d="M124,246.0313 L124,294.0313 A3.5,3.5 0 0 0 127.5,297.5313 L235.5,297.5313 A3.5,3.5 0 0 0 239,294.0313 L239,252.5313 L229,242.5313 L127.5,242.5313 A3.5,3.5 0 0 0 124,246.0313 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,242.5313 L229,250.7813 A1.75,1.75 0 0 0 230.75,252.5313 L239,252.5313 L229,242.5313 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="94" x="130" y="256.874">Salt: 8 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="80" x="130" y="268.1943">Key: 64 characters</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="65" x="130" y="279.5146">Iterations: 1000</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="65" x="130" y="290.835">Hash: SHA-256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="328.582" y2="328.582"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="328.582" y2="341.582"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="341.582" y2="341.582"/><polygon fill="#CD5764" points="265,337.582,255,341.582,265,345.582,261,341.582" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="97" x="261" y="324.3848">Encrypt the plaintext</text><path d="M120,311.3125 L120,347.3125 A3.5,3.5 0 0 0 123.5,350.8125 L235.5,350.8125 A3.5,3.5 0 0 0 239,347.3125 L239,317.8125 L229,307.8125 L123.5,307.8125 A3.5,3.5 0 0 0 120,311.3125 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,307.8125 L229,316.0625 A1.75,1.75 0 0 0 230.75,317.8125 L239,317.8125 L229,307.8125 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="98" x="126" y="322.1553">DeriveKey (see above)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="92" x="126" y="333.4756">IV: 12 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="66" x="126" y="344.7959">Algo: AES-GCM</text><polygon fill="#CD5764" points="478,371.3516,488,375.3516,478,379.3516,482,375.3516" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="484" y1="375.3516" y2="375.3516"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="195" x="261" y="371.1543">Upload the ciphertext to the API endpoint</text><path d="M347.5,390.3516 L405,390.3516 L405,398.7031 L395,408.7031 L344,408.7031 L344,393.8516 A3.5,3.5 0 0 1 347.5,390.3516 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="196.0703" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="487" x="344" y="390.3516"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="359" y="404.8467">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="420" y="403.7705">[Double-Encryption active]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="542" y1="434.4727" y2="434.4727"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="542" x2="542" y1="434.4727" y2="447.4727"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="501" x2="542" y1="447.4727" y2="447.4727"/><polygon fill="#CD5764" points="511,443.4727,501,447.4727,511,451.4727,507,447.4727" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="127" x="507" y="430.2754">Encrypt received ciphertext</text><path d="M354,417.2031 L354,453.2031 A3.5,3.5 0 0 0 357.5,456.7031 L481.5,456.7031 A3.5,3.5 0 0 0 485,453.2031 L485,423.7031 L475,413.7031 L357.5,413.7031 A3.5,3.5 0 0 0 354,417.2031 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M475,413.7031 L475,421.9531 A1.75,1.75 0 0 0 476.75,423.7031 L485,423.7031 L475,413.7031 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="60" x="360" y="428.0459">Key: 32 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="110" x="360" y="439.3662">Nonce: 12 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="107" x="360" y="450.6865">Algo: ChaCha20Poly1305</text><polygon fill="#CD5764" points="638,496.5938,648,500.5938,638,504.5938,642,500.5938" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="644" y1="500.5938" y2="500.5938"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="126" x="507" y="496.3965">Store data in the database</text><path d="M665,471.1641 L665,519.1641 A3.5,3.5 0 0 0 668.5,522.6641 L817.5,522.6641 A3.5,3.5 0 0 0 821,519.1641 L821,477.6641 L811,467.6641 L668.5,467.6641 A3.5,3.5 0 0 0 665,471.1641 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M811,467.6641 L811,475.9141 A1.75,1.75 0 0 0 812.75,477.6641 L821,477.6641 L811,467.6641 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="671" y="482.0068">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="89" x="671" y="493.3271">Nonce: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="77" x="671" y="504.6475">Tag: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="135" x="671" y="515.9678">CreatedDate: DateTime.UtcNow</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344" x2="831" y1="528.9453" y2="528.9453"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="150" x="349" y="540.3643">[Double-Encryption not set]</text><polygon fill="#CD5764" points="638,566.3906,648,570.3906,638,574.3906,642,570.3906" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="644" y1="570.3906" y2="570.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="126" x="507" y="566.1934">Store data in the database</text><path d="M665,552.2813 L665,577.2813 A3.5,3.5 0 0 0 668.5,580.7813 L817.5,580.7813 A3.5,3.5 0 0 0 821,577.2813 L821,558.7813 L811,548.7813 L668.5,548.7813 A3.5,3.5 0 0 0 665,552.2813 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M811,548.7813 L811,557.0313 A1.75,1.75 0 0 0 812.75,558.7813 L821,558.7813 L811,548.7813 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="671" y="563.124">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="135" x="671" y="574.4443">CreatedDate: DateTime.UtcNow</text><polygon fill="#CD5764" points="511,608,501,612,511,616,507,612" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="649" y1="612" y2="612"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="83" x="517" y="607.8027">Success message</text><polygon fill="#CD5764" points="265,659.5898,255,663.5898,265,667.5898,261,663.5898" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="259" x2="489" y1="663.5898" y2="663.5898"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="94" x="271" y="659.3926">Feedback of upload</text><path d="M90,628.5 L90,687.5 A3.5,3.5 0 0 0 93.5,691 L235.5,691 A3.5,3.5 0 0 0 239,687.5 L239,635 L229,625 L93.5,625 A3.5,3.5 0 0 0 90,628.5 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,625 L229,633.25 A1.75,1.75 0 0 0 230.75,635 L239,635 L229,625 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="74" x="96" y="639.3428">UploadState: bool</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="128" x="96" y="650.6631">Timestamp: DateTime.UtcNow</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="95" x="96" y="661.9834">UploadMessage: string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="96" y="673.3037">UploadId: Guid</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="122" x="96" y="684.624">UploadOriginalHash: SHA256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="715.1797" y2="715.1797"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="715.1797" y2="728.1797"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="728.1797" y2="728.1797"/><polygon fill="#CD5764" points="265,724.1797,255,728.1797,265,732.1797,261,728.1797" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="222" x="261" y="710.9824">Check if the hash value matches the local hash</text><path d="M13.5,743.1797 L71,743.1797 L71,751.5313 L61,761.5313 L10,761.5313 L10,746.6797 A3.5,3.5 0 0 1 13.5,743.1797 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="141.3047" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="369" x="10" y="743.1797"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="757.6748">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="98" x="86" y="756.5986">[Successful case]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="787.3008" y2="787.3008"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="787.3008" y2="800.3008"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="800.3008" y2="800.3008"/><polygon fill="#CD5764" points="265,796.3008,255,800.3008,265,804.3008,261,800.3008" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="116" x="261" y="783.1035">Generate the Share-URL</text><path d="M93,770.0313 L93,806.0313 A3.5,3.5 0 0 0 96.5,809.5313 L235.5,809.5313 A3.5,3.5 0 0 0 239,806.0313 L239,776.5313 L229,766.5313 L96.5,766.5313 A3.5,3.5 0 0 0 93,770.0313 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,766.5313 L229,774.7813 A1.75,1.75 0 0 0 230.75,776.5313 L239,776.5313 L229,766.5313 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="99" y="780.874">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="78" x="99" y="792.1943">&lt;origin&gt;/exchange/</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="125" x="99" y="803.5146">?data=&lt;id&gt;#&lt;key&gt;-&lt;salt&gt;-&lt;iv&gt;</text><polygon fill="#CD5764" points="49,830.0703,39,834.0703,49,838.0703,45,834.0703" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="834.0703" y2="834.0703"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="136" x="55" y="829.873">Success box with Share-URL</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="379" y1="843.0703" y2="843.0703"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65" x="15" y="854.4893">[Error case]</text><polygon fill="#CD5764" points="49,872.4844,39,876.4844,49,880.4844,45,876.4844" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="876.4844" y2="876.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="182" x="55" y="872.2871">Error box with corresponding message.</text><line style="stroke:#393939;stroke-width:2.0;" x1="240" x2="258" y1="891.4844" y2="909.4844"/><line style="stroke:#393939;stroke-width:2.0;" x1="240" x2="258" y1="909.4844" y2="891.4844"/><rect fill="#F9F9F9" height="12.5781" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="171" x="334.5" y="997.0938"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="171" x="334.5" y="1007.4746">AnnOtter - Way to Secure Exchange</text><!--MD5=[bc3a04cefcfbd2121d5dc7a11578216b]
@startuml

!include theme/annotter-theme.puml

title "Encryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend
participant Backend
database Database

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Click generate

Frontend -> Frontend : Generate a PBKDF2 DeriveKey
note left
  Salt: 8 bytes (random)
  Key: 64 characters
  Iterations: 1000
  Hash: SHA-256
end note

Frontend -> Frontend : Encrypt the plaintext
note left
  DeriveKey (see above)
  IV: 12 bytes (random)
  Algo: AES-GCM
end note

Frontend -> Backend : Upload the ciphertext to the API endpoint
activate Backend

    alt Double-Encryption active
        Backend -> Backend : Encrypt received ciphertext
            note left
            Key: 32 bytes
            Nonce: 12 bytes (random)
            Algo: ChaCha20Poly1305
            end note
        Backend -> Database : Store data in the database
        activate Database
            note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    else Double-Encryption not set
        Backend -> Database : Store data in the database
            note right
            Ciphertext: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    end
    
    Database - -> Backend : Success message

    Backend - -> Frontend : Feedback of upload
        note left
        UploadState: bool
        Timestamp: DateTime.UtcNow
        UploadMessage: string
        UploadId: Guid
        UploadOriginalHash: SHA256
        end note

Frontend -> Frontend : Check if the hash value matches the local hash

    alt Successful case
        Frontend -> Frontend : Generate the Share-URL
            note left
            Format: 
            <origin>/exchange/
            ?data=<id>#<key>-<salt>-<iv>
            end note
        Frontend - -> Alice : Success box with Share-URL
    else Error case
        Frontend - -> Alice: Error box with corresponding message.
    end

destroy Frontend

@enduml

@startuml

skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor cd5764
skinparam FontColor 191919
skinparam ArrowFontSize 10
skinparam ArrowFontStyle italic
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceLifeLineBorderThickness 2
skinparam SequenceLifeLineBackgroundColor aabacf
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1
skinparam SequenceGroupBackgroundColor f4d891
skinparam SequenceGroupBodyBackgroundColor f4f2ee
skinparam SequenceArrowThickness 1
skinparam NoteFontSize 9

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor 4b525b
    BorderColor 191919
    FontColor FFF
    BorderThickness 1
}

skinparam database {
    BackgroundColor 6a7481
    BorderColor FFF
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor C9C9C9
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam alt {
    BackgroundColor f4efe2
}

title "Encryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend
participant Backend
database Database

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Click generate

Frontend -> Frontend : Generate a PBKDF2 DeriveKey
note left
  Salt: 8 bytes (random)
  Key: 64 characters
  Iterations: 1000
  Hash: SHA-256
end note

Frontend -> Frontend : Encrypt the plaintext
note left
  DeriveKey (see above)
  IV: 12 bytes (random)
  Algo: AES-GCM
end note

Frontend -> Backend : Upload the ciphertext to the API endpoint
activate Backend

    alt Double-Encryption active
        Backend -> Backend : Encrypt received ciphertext
            note left
            Key: 32 bytes
            Nonce: 12 bytes (random)
            Algo: ChaCha20Poly1305
            end note
        Backend -> Database : Store data in the database
        activate Database
            note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    else Double-Encryption not set
        Backend -> Database : Store data in the database
            note right
            Ciphertext: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    end
    
    Database - -> Backend : Success message

    Backend - -> Frontend : Feedback of upload
        note left
        UploadState: bool
        Timestamp: DateTime.UtcNow
        UploadMessage: string
        UploadId: Guid
        UploadOriginalHash: SHA256
        end note

Frontend -> Frontend : Check if the hash value matches the local hash

    alt Successful case
        Frontend -> Frontend : Generate the Share-URL
            note left
            Format: 
            <origin>/exchange/
            ?data=<id>#<key>-<salt>-<iv>
            end note
        Frontend - -> Alice : Success box with Share-URL
    else Error case
        Frontend - -> Alice: Error box with corresponding message.
    end

destroy Frontend

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: CH
--></g></svg>