<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="991px" preserveAspectRatio="none" style="width:838px;height:991px;background:#F9F9F9;" version="1.1" viewBox="0 0 838 991" width="838px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="27.6094" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="146" x="347" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="352" y="29.5332">Encryption Process</text><rect fill="#AABACF" height="715.9844" style="stroke:#393939;stroke-width:1.0;" width="10" x="244" y="149.7969"/><rect fill="#AABACF" height="535.1328" style="stroke:#393939;stroke-width:1.0;" width="10" x="490" y="349.6484"/><rect fill="#AABACF" height="409.8906" style="stroke:#393939;stroke-width:1.0;" width="10" x="650" y="474.8906"/><rect fill="#F4F2EE" height="196.0703" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="487" x="344" y="364.6484"/><path d="M344,502.2422 L831,502.2422 L831,557.2188 A3.5,3.5 0 0 1 827.5,560.7188 L347.5,560.7188 A3.5,3.5 0 0 1 344,557.2188 L344,502.2422 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><rect fill="#F4F2EE" height="141.3047" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="369" x="10" y="717.4766"/><path d="M10,816.3672 L379,816.3672 L379,855.2813 A3.5,3.5 0 0 1 375.5,858.7813 L13.5,858.7813 A3.5,3.5 0 0 1 10,855.2813 L10,816.3672 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="121.2188" y2="893.7813"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="249" x2="249" y1="121.2188" y2="893.7813"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="494.5" x2="494.5" y1="121.2188" y2="893.7813"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="654.5" x2="654.5" y1="121.2188" y2="893.7813"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="118.1426">Alice</text><ellipse cx="38" cy="52.1094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,60.1094 L38,87.1094 M25,68.1094 L51,68.1094 M38,87.1094 L25,102.1094 M38,87.1094 L51,102.1094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="907.3145">Alice</text><ellipse cx="38" cy="918.8906" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,926.8906 L38,953.8906 M25,934.8906 L51,934.8906 M38,953.8906 L25,968.8906 M38,953.8906 L51,968.8906 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="213" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="220" y="110.1426">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="213" y="892.7813"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="220" y="914.3145">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="460.5" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="467.5" y="110.1426">Backend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="460.5" y="892.7813"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="467.5" y="914.3145">Backend</text><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="621.5" y="118.1426">Database</text><path d="M637,67.6094 C637,57.6094 655,57.6094 655,57.6094 C655,57.6094 673,57.6094 673,67.6094 L673,93.6094 C673,103.6094 655,103.6094 655,103.6094 C655,103.6094 637,103.6094 637,93.6094 L637,67.6094 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M637,67.6094 C637,77.6094 655,77.6094 655,77.6094 C655,77.6094 673,77.6094 673,67.6094 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="621.5" y="907.3145">Database</text><path d="M637,920.3906 C637,910.3906 655,910.3906 655,910.3906 C655,910.3906 673,910.3906 673,920.3906 L673,946.3906 C673,956.3906 655,956.3906 655,956.3906 C655,956.3906 637,956.3906 637,946.3906 L637,920.3906 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M637,920.3906 C637,930.3906 655,930.3906 655,930.3906 C655,930.3906 673,930.3906 673,920.3906 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><rect fill="#AABACF" height="715.9844" style="stroke:#393939;stroke-width:1.0;" width="10" x="244" y="149.7969"/><rect fill="#AABACF" height="535.1328" style="stroke:#393939;stroke-width:1.0;" width="10" x="490" y="349.6484"/><rect fill="#AABACF" height="409.8906" style="stroke:#393939;stroke-width:1.0;" width="10" x="650" y="474.8906"/><polygon fill="#CD5764" points="232,145.7969,242,149.7969,232,153.7969,236,149.7969" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="149.7969" y2="149.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="106" x="45" y="145.5996">Start to create a secret</text><polygon fill="#CD5764" points="49,172.375,39,176.375,49,180.375,45,176.375" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="176.375" y2="176.375"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="124" x="55" y="172.1777">Receive initial application</text><polygon fill="#CD5764" points="232,198.9531,242,202.9531,232,206.9531,236,202.9531" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="202.9531" y2="202.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="76" x="45" y="198.7559">Enter secret text</text><polygon fill="#CD5764" points="232,225.5313,242,229.5313,232,233.5313,236,229.5313" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="238" y1="229.5313" y2="229.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="68" x="45" y="225.334">Click generate</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="256.1094" y2="256.1094"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="256.1094" y2="269.1094"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="269.1094" y2="269.1094"/><polygon fill="#CD5764" points="265,265.1094,255,269.1094,265,273.1094,261,269.1094" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="104" x="261" y="251.9121">Generate a CryptoKey</text><path d="M134,250.1602 L134,264.1602 A3.5,3.5 0 0 0 137.5,267.6602 L235.5,267.6602 A3.5,3.5 0 0 0 239,264.1602 L239,256.6602 L229,246.6602 L137.5,246.6602 A3.5,3.5 0 0 0 134,250.1602 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,246.6602 L229,254.9102 A1.75,1.75 0 0 0 230.75,256.6602 L239,256.6602 L229,246.6602 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="84" x="140" y="261.0029">Algo: AES-GCM-256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="302.8789" y2="302.8789"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="302.8789" y2="315.8789"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="315.8789" y2="315.8789"/><polygon fill="#CD5764" points="265,311.8789,255,315.8789,265,319.8789,261,315.8789" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="97" x="261" y="298.6816">Encrypt the plaintext</text><path d="M119,285.6094 L119,321.6094 A3.5,3.5 0 0 0 122.5,325.1094 L235.5,325.1094 A3.5,3.5 0 0 0 239,321.6094 L239,292.1094 L229,282.1094 L122.5,282.1094 A3.5,3.5 0 0 0 119,285.6094 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,282.1094 L229,290.3594 A1.75,1.75 0 0 0 230.75,292.1094 L239,292.1094 L229,282.1094 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="99" x="125" y="296.4521">CryptoKey (see above)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="92" x="125" y="307.7725">IV: 12 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="66" x="125" y="319.0928">Algo: AES-GCM</text><polygon fill="#CD5764" points="478,345.6484,488,349.6484,478,353.6484,482,349.6484" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="484" y1="349.6484" y2="349.6484"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="195" x="261" y="345.4512">Upload the ciphertext to the API endpoint</text><path d="M347.5,364.6484 L405,364.6484 L405,373 L395,383 L344,383 L344,368.1484 A3.5,3.5 0 0 1 347.5,364.6484 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="196.0703" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="487" x="344" y="364.6484"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="359" y="379.1436">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="420" y="378.0674">[Double-Encryption active]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="542" y1="408.7695" y2="408.7695"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="542" x2="542" y1="408.7695" y2="421.7695"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="501" x2="542" y1="421.7695" y2="421.7695"/><polygon fill="#CD5764" points="511,417.7695,501,421.7695,511,425.7695,507,421.7695" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="127" x="507" y="404.5723">Encrypt received ciphertext</text><path d="M354,391.5 L354,427.5 A3.5,3.5 0 0 0 357.5,431 L481.5,431 A3.5,3.5 0 0 0 485,427.5 L485,398 L475,388 L357.5,388 A3.5,3.5 0 0 0 354,391.5 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M475,388 L475,396.25 A1.75,1.75 0 0 0 476.75,398 L485,398 L475,388 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="60" x="360" y="402.3428">Key: 32 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="110" x="360" y="413.6631">Nonce: 12 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="107" x="360" y="424.9834">Algo: ChaCha20Poly1305</text><polygon fill="#CD5764" points="638,470.8906,648,474.8906,638,478.8906,642,474.8906" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="644" y1="474.8906" y2="474.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="126" x="507" y="470.6934">Store data in the database</text><path d="M665,445.4609 L665,493.4609 A3.5,3.5 0 0 0 668.5,496.9609 L817.5,496.9609 A3.5,3.5 0 0 0 821,493.4609 L821,451.9609 L811,441.9609 L668.5,441.9609 A3.5,3.5 0 0 0 665,445.4609 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M811,441.9609 L811,450.2109 A1.75,1.75 0 0 0 812.75,451.9609 L821,451.9609 L811,441.9609 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="671" y="456.3037">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="89" x="671" y="467.624">Nonce: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="77" x="671" y="478.9443">Tag: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="135" x="671" y="490.2646">CreatedDate: DateTime.UtcNow</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344" x2="831" y1="503.2422" y2="503.2422"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="150" x="349" y="514.6611">[Double-Encryption not set]</text><polygon fill="#CD5764" points="638,540.6875,648,544.6875,638,548.6875,642,544.6875" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="500" x2="644" y1="544.6875" y2="544.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="126" x="507" y="540.4902">Store data in the database</text><path d="M665,526.5781 L665,551.5781 A3.5,3.5 0 0 0 668.5,555.0781 L817.5,555.0781 A3.5,3.5 0 0 0 821,551.5781 L821,533.0781 L811,523.0781 L668.5,523.0781 A3.5,3.5 0 0 0 665,526.5781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M811,523.0781 L811,531.3281 A1.75,1.75 0 0 0 812.75,533.0781 L821,533.0781 L811,523.0781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="671" y="537.4209">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="135" x="671" y="548.7412">CreatedDate: DateTime.UtcNow</text><polygon fill="#CD5764" points="511,582.2969,501,586.2969,511,590.2969,507,586.2969" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="649" y1="586.2969" y2="586.2969"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="83" x="517" y="582.0996">Success message</text><polygon fill="#CD5764" points="265,633.8867,255,637.8867,265,641.8867,261,637.8867" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="259" x2="489" y1="637.8867" y2="637.8867"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="94" x="271" y="633.6895">Feedback of upload</text><path d="M90,602.7969 L90,661.7969 A3.5,3.5 0 0 0 93.5,665.2969 L235.5,665.2969 A3.5,3.5 0 0 0 239,661.7969 L239,609.2969 L229,599.2969 L93.5,599.2969 A3.5,3.5 0 0 0 90,602.7969 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,599.2969 L229,607.5469 A1.75,1.75 0 0 0 230.75,609.2969 L239,609.2969 L229,599.2969 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="74" x="96" y="613.6396">UploadState: bool</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="128" x="96" y="624.96">Timestamp: DateTime.UtcNow</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="95" x="96" y="636.2803">UploadMessage: string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="96" y="647.6006">UploadId: Guid</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="122" x="96" y="658.9209">UploadOriginalHash: SHA256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="689.4766" y2="689.4766"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="689.4766" y2="702.4766"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="702.4766" y2="702.4766"/><polygon fill="#CD5764" points="265,698.4766,255,702.4766,265,706.4766,261,702.4766" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="222" x="261" y="685.2793">Check if the hash value matches the local hash</text><path d="M13.5,717.4766 L71,717.4766 L71,725.8281 L61,735.8281 L10,735.8281 L10,720.9766 A3.5,3.5 0 0 1 13.5,717.4766 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="141.3047" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="369" x="10" y="717.4766"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="731.9717">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="98" x="86" y="730.8955">[Successful case]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="254" x2="296" y1="761.5977" y2="761.5977"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="296" x2="296" y1="761.5977" y2="774.5977"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="255" x2="296" y1="774.5977" y2="774.5977"/><polygon fill="#CD5764" points="265,770.5977,255,774.5977,265,778.5977,261,774.5977" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="116" x="261" y="757.4004">Generate the Share-URL</text><path d="M121,744.3281 L121,780.3281 A3.5,3.5 0 0 0 124.5,783.8281 L235.5,783.8281 A3.5,3.5 0 0 0 239,780.3281 L239,750.8281 L229,740.8281 L124.5,740.8281 A3.5,3.5 0 0 0 121,744.3281 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M229,740.8281 L229,749.0781 A1.75,1.75 0 0 0 230.75,750.8281 L239,750.8281 L229,740.8281 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="127" y="755.1709">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="78" x="127" y="766.4912">&lt;origin&gt;/exchange/</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="97" x="127" y="777.8115">?data=&lt;id&gt;#&lt;key&gt;-&lt;iv&gt;</text><polygon fill="#CD5764" points="49,804.3672,39,808.3672,49,812.3672,45,808.3672" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="808.3672" y2="808.3672"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="136" x="55" y="804.1699">Success box with Share-URL</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="379" y1="817.3672" y2="817.3672"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65" x="15" y="828.7861">[Error case]</text><polygon fill="#CD5764" points="49,846.7813,39,850.7813,49,854.7813,45,850.7813" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="243" y1="850.7813" y2="850.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="182" x="55" y="846.584">Error box with corresponding message.</text><line style="stroke:#393939;stroke-width:2.0;" x1="240" x2="258" y1="865.7813" y2="883.7813"/><line style="stroke:#393939;stroke-width:2.0;" x1="240" x2="258" y1="883.7813" y2="865.7813"/><rect fill="#F9F9F9" height="12.5781" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="171" x="334.5" y="971.3906"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="171" x="334.5" y="981.7715">AnnOtter - Way to Secure Exchange</text><!--MD5=[266828399332119e7444511d097e20ac]
@startuml

!include theme/annotter-theme.puml

title "Encryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend
participant Backend
database Database

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Click generate

Frontend -> Frontend : Generate a CryptoKey
note left
  Algo: AES-GCM-256
end note

Frontend -> Frontend : Encrypt the plaintext
note left
  CryptoKey (see above)
  IV: 12 bytes (random)
  Algo: AES-GCM
end note

Frontend -> Backend : Upload the ciphertext to the API endpoint
activate Backend

    alt Double-Encryption active
        Backend -> Backend : Encrypt received ciphertext
            note left
            Key: 32 bytes
            Nonce: 12 bytes (random)
            Algo: ChaCha20Poly1305
            end note
        Backend -> Database : Store data in the database
        activate Database
            note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    else Double-Encryption not set
        Backend -> Database : Store data in the database
            note right
            Ciphertext: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    end
    
    Database - -> Backend : Success message

    Backend - -> Frontend : Feedback of upload
        note left
        UploadState: bool
        Timestamp: DateTime.UtcNow
        UploadMessage: string
        UploadId: Guid
        UploadOriginalHash: SHA256
        end note

Frontend -> Frontend : Check if the hash value matches the local hash

    alt Successful case
        Frontend -> Frontend : Generate the Share-URL
            note left
            Format: 
            <origin>/exchange/
            ?data=<id>#<key>-<iv>
            end note
        Frontend - -> Alice : Success box with Share-URL
    else Error case
        Frontend - -> Alice: Error box with corresponding message.
    end

destroy Frontend

@enduml

@startuml

skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor cd5764
skinparam FontColor 191919
skinparam ArrowFontSize 10
skinparam ArrowFontStyle italic
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceLifeLineBorderThickness 2
skinparam SequenceLifeLineBackgroundColor aabacf
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1
skinparam SequenceGroupBackgroundColor f4d891
skinparam SequenceGroupBodyBackgroundColor f4f2ee
skinparam SequenceArrowThickness 1
skinparam NoteFontSize 9

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor 4b525b
    BorderColor 191919
    FontColor FFF
    BorderThickness 1
}

skinparam database {
    BackgroundColor 6a7481
    BorderColor FFF
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor C9C9C9
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam alt {
    BackgroundColor f4efe2
}

title "Encryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend
participant Backend
database Database

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Click generate

Frontend -> Frontend : Generate a CryptoKey
note left
  Algo: AES-GCM-256
end note

Frontend -> Frontend : Encrypt the plaintext
note left
  CryptoKey (see above)
  IV: 12 bytes (random)
  Algo: AES-GCM
end note

Frontend -> Backend : Upload the ciphertext to the API endpoint
activate Backend

    alt Double-Encryption active
        Backend -> Backend : Encrypt received ciphertext
            note left
            Key: 32 bytes
            Nonce: 12 bytes (random)
            Algo: ChaCha20Poly1305
            end note
        Backend -> Database : Store data in the database
        activate Database
            note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    else Double-Encryption not set
        Backend -> Database : Store data in the database
            note right
            Ciphertext: base64 string
            CreatedDate: DateTime.UtcNow
            end note
    end
    
    Database - -> Backend : Success message

    Backend - -> Frontend : Feedback of upload
        note left
        UploadState: bool
        Timestamp: DateTime.UtcNow
        UploadMessage: string
        UploadId: Guid
        UploadOriginalHash: SHA256
        end note

Frontend -> Frontend : Check if the hash value matches the local hash

    alt Successful case
        Frontend -> Frontend : Generate the Share-URL
            note left
            Format: 
            <origin>/exchange/
            ?data=<id>#<key>-<iv>
            end note
        Frontend - -> Alice : Success box with Share-URL
    else Error case
        Frontend - -> Alice: Error box with corresponding message.
    end

destroy Frontend

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: CH
--></g></svg>