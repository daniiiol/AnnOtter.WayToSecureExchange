<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="667px" preserveAspectRatio="none" style="width:416px;height:667px;background:#F9F9F9;" version="1.1" viewBox="0 0 416 667" width="416px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="27.6094" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="176" x="122" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="166" x="127" y="29.5332">URL Protection Process</text><rect fill="#AABACF" height="204.5625" style="stroke:#AABACF;stroke-width:1.0;" width="10" x="198" y="149.7969"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="198" y1="149.7969" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="208" x2="208" y1="149.7969" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="208" y1="149.7969" y2="149.7969"/><rect fill="#AABACF" height="169.1406" style="stroke:#AABACF;stroke-width:1.0;" width="10" x="198" y="382.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="198" y1="382.3594" y2="551.5"/><line style="stroke:#393939;stroke-width:1.0;" x1="208" x2="208" y1="382.3594" y2="551.5"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="208" y1="551.5" y2="551.5"/><rect fill="#F4F2EE" height="44.9297" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="239" x="10" y="244.5313"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="121.2188" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="38" x2="38" y1="354.3594" y2="382.3594"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="382.3594" y2="569.5"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="203" x2="203" y1="121.2188" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="203" x2="203" y1="354.3594" y2="382.3594"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="203" x2="203" y1="382.3594" y2="569.5"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="118.1426">Alice</text><ellipse cx="38" cy="52.1094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,60.1094 L38,87.1094 M25,68.1094 L51,68.1094 M38,87.1094 L25,102.1094 M38,87.1094 L51,102.1094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="20" y="583.0332">Alice</text><ellipse cx="38" cy="594.6094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M38,602.6094 L38,629.6094 M25,610.6094 L51,610.6094 M38,629.6094 L25,644.6094 M38,629.6094 L51,644.6094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="167" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="174" y="110.1426">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="167" y="568.5"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="174" y="590.0332">Frontend</text><rect fill="#AABACF" height="204.5625" style="stroke:#AABACF;stroke-width:1.0;" width="10" x="198" y="149.7969"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="198" y1="149.7969" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="208" x2="208" y1="149.7969" y2="354.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="208" y1="149.7969" y2="149.7969"/><rect fill="#AABACF" height="169.1406" style="stroke:#AABACF;stroke-width:1.0;" width="10" x="198" y="382.3594"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="198" y1="382.3594" y2="551.5"/><line style="stroke:#393939;stroke-width:1.0;" x1="208" x2="208" y1="382.3594" y2="551.5"/><line style="stroke:#393939;stroke-width:1.0;" x1="198" x2="208" y1="551.5" y2="551.5"/><polygon fill="#CD5764" points="186,145.7969,196,149.7969,186,153.7969,190,149.7969" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="192" y1="149.7969" y2="149.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="106" x="45" y="145.5996">Start to create a secret</text><polygon fill="#CD5764" points="49,172.375,39,176.375,49,180.375,45,176.375" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="197" y1="176.375" y2="176.375"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="124" x="55" y="172.1777">Receive initial application</text><polygon fill="#CD5764" points="186,198.9531,196,202.9531,186,206.9531,190,202.9531" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="192" y1="202.9531" y2="202.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="76" x="45" y="198.7559">Enter secret text</text><polygon fill="#CD5764" points="186,225.5313,196,229.5313,186,233.5313,190,229.5313" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="192" y1="229.5313" y2="229.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="111" x="45" y="225.334">Activate URL protection</text><path d="M13.5,244.5313 L75,244.5313 L75,252.8828 L65,262.8828 L10,262.8828 L10,248.0313 A3.5,3.5 0 0 1 13.5,244.5313 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="44.9297" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="239" x="10" y="244.5313"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="25" y="259.0264">opt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="90" y="257.9502">[Shuffle Key]</text><polygon fill="#CD5764" points="186,277.4609,196,281.4609,186,285.4609,190,281.4609" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="192" y1="281.4609" y2="281.4609"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="125" x="45" y="277.2637">Click on refresh key button</text><polygon fill="#CD5764" points="49,313.4102,39,317.4102,49,321.4102,45,317.4102" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="43" x2="197" y1="317.4102" y2="317.4102"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="132" x="55" y="313.2129">Receive URL encryption key</text><path d="M213,304.9609 L213,318.9609 A3.5,3.5 0 0 0 216.5,322.4609 L354.5,322.4609 A3.5,3.5 0 0 0 358,318.9609 L358,311.4609 L348,301.4609 L216.5,301.4609 A3.5,3.5 0 0 0 213,304.9609 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M348,301.4609 L348,309.7109 A1.75,1.75 0 0 0 349.75,311.4609 L358,311.4609 L348,301.4609 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="124" x="219" y="315.8037">CryptoKey for AES-GCM-256</text><polygon fill="#CD5764" points="186,342.3594,196,346.3594,186,350.3594,190,346.3594" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="38" x2="192" y1="346.3594" y2="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="68" x="45" y="342.1621">Click generate</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="208" x2="250" y1="408.1289" y2="408.1289"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="250" x2="250" y1="408.1289" y2="421.1289"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="209" x2="250" y1="421.1289" y2="421.1289"/><polygon fill="#CD5764" points="219,417.1289,209,421.1289,219,425.1289,215,421.1289" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="116" x="215" y="403.9316">Generate the Share-URL</text><path d="M75,390.8594 L75,426.8594 A3.5,3.5 0 0 0 78.5,430.3594 L189.5,430.3594 A3.5,3.5 0 0 0 193,426.8594 L193,397.3594 L183,387.3594 L78.5,387.3594 A3.5,3.5 0 0 0 75,390.8594 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M183,387.3594 L183,395.6094 A1.75,1.75 0 0 0 184.75,397.3594 L193,397.3594 L183,387.3594 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="81" y="401.7021">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="78" x="81" y="413.0225">&lt;origin&gt;/exchange/</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="97" x="81" y="424.3428">?data=&lt;id&gt;#&lt;key&gt;-&lt;iv&gt;</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="208" x2="250" y1="462.0898" y2="462.0898"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="250" x2="250" y1="462.0898" y2="475.0898"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="209" x2="250" y1="475.0898" y2="475.0898"/><polygon fill="#CD5764" points="219,471.0898,209,475.0898,219,479.0898,215,475.0898" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="194" x="215" y="457.8926">Encrypt the UrlParam Part with CryptoKey</text><path d="M73,444.8203 L73,480.8203 A3.5,3.5 0 0 0 76.5,484.3203 L189.5,484.3203 A3.5,3.5 0 0 0 193,480.8203 L193,451.3203 L183,441.3203 L76.5,441.3203 A3.5,3.5 0 0 0 73,444.8203 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M183,441.3203 L183,449.5703 A1.75,1.75 0 0 0 184.75,451.3203 L193,451.3203 L183,441.3203 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="99" x="79" y="455.6631">CryptoKey (see above)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="92" x="79" y="466.9834">IV: 12 bytes (random)</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="66" x="79" y="478.3037">Algo: AES-GCM</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="208" x2="250" y1="510.3906" y2="510.3906"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="250" x2="250" y1="510.3906" y2="523.3906"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="209" x2="250" y1="523.3906" y2="523.3906"/><polygon fill="#CD5764" points="219,519.3906,209,523.3906,219,527.3906,215,523.3906" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="145" x="215" y="506.1934">Generate protected Share-URL</text><path d="M19,498.7813 L19,523.7813 A3.5,3.5 0 0 0 22.5,527.2813 L189.5,527.2813 A3.5,3.5 0 0 0 193,523.7813 L193,505.2813 L183,495.2813 L22.5,495.2813 A3.5,3.5 0 0 0 19,498.7813 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M183,495.2813 L183,503.5313 A1.75,1.75 0 0 0 184.75,505.2813 L193,505.2813 L183,495.2813 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="25" y="509.624">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="153" x="25" y="520.9443">&lt;origin&gt;/protect/#P-&lt;ciphertext&gt;-&lt;iv&gt;</text><polygon fill="#CD5764" points="49,547.5,39,551.5,49,555.5,45,551.5" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43" x2="202" y1="551.5" y2="551.5"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="136" x="55" y="547.3027">Success box with Share-URL</text><line style="stroke:#393939;stroke-width:2.0;" x1="194" x2="212" y1="542.5" y2="560.5"/><line style="stroke:#393939;stroke-width:2.0;" x1="194" x2="212" y1="560.5" y2="542.5"/><rect fill="#F9F9F9" height="12.5781" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="171" x="124.5" y="647.1094"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="171" x="124.5" y="657.4902">AnnOtter - Way to Secure Exchange</text><!--MD5=[0bc7038d09a25a3a76471e6bffbe73af]
@startuml

!include theme/annotter-theme.puml

title "URL Protection Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Activate URL protection

opt Shuffle Key
Alice -> Frontend : Click on refresh key button
end 

Frontend -> Alice : Receive URL encryption key
    note right
    CryptoKey for AES-GCM-256
    end note

Alice -> Frontend : Click generate

...

Frontend -> Frontend : Generate the Share-URL
    note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<iv>
    end note

Frontend -> Frontend : Encrypt the UrlParam Part with CryptoKey
    note left
    CryptoKey (see above)
    IV: 12 bytes (random)
    Algo: AES-GCM
    end note

Frontend -> Frontend : Generate protected Share-URL
    note left
    Format: 
    <origin>/protect/#P-<ciphertext>-<iv>
    end note

Frontend - -> Alice : Success box with Share-URL

destroy Frontend

@enduml

@startuml

skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor cd5764
skinparam FontColor 191919
skinparam ArrowFontSize 10
skinparam ArrowFontStyle italic
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceLifeLineBorderThickness 2
skinparam SequenceLifeLineBackgroundColor aabacf
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1
skinparam SequenceGroupBackgroundColor f4d891
skinparam SequenceGroupBodyBackgroundColor f4f2ee
skinparam SequenceArrowThickness 1
skinparam NoteFontSize 9

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor 4b525b
    BorderColor 191919
    FontColor FFF
    BorderThickness 1
}

skinparam database {
    BackgroundColor 6a7481
    BorderColor FFF
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor C9C9C9
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam alt {
    BackgroundColor f4efe2
}

title "URL Protection Process"
footer "AnnOtter - Way to Secure Exchange"

actor Alice
participant Frontend

Alice -> Frontend : Start to create a secret
activate Frontend
Frontend - -> Alice : Receive initial application

Alice -> Frontend : Enter secret text

Alice -> Frontend : Activate URL protection

opt Shuffle Key
Alice -> Frontend : Click on refresh key button
end 

Frontend -> Alice : Receive URL encryption key
    note right
    CryptoKey for AES-GCM-256
    end note

Alice -> Frontend : Click generate

...

Frontend -> Frontend : Generate the Share-URL
    note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<iv>
    end note

Frontend -> Frontend : Encrypt the UrlParam Part with CryptoKey
    note left
    CryptoKey (see above)
    IV: 12 bytes (random)
    Algo: AES-GCM
    end note

Frontend -> Frontend : Generate protected Share-URL
    note left
    Format: 
    <origin>/protect/#P-<ciphertext>-<iv>
    end note

Frontend - -> Alice : Success box with Share-URL

destroy Frontend

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: CH
--></g></svg>