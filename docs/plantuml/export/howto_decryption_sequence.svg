<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1135px" preserveAspectRatio="none" style="width:1043px;height:1135px;background:#F9F9F9;" version="1.1" viewBox="0 0 1043 1135" width="1043px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="27.6094" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="147" x="449.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="137" x="454.25" y="29.5332">Decryption Process</text><rect fill="#AABACF" height="865.0195" style="stroke:#393939;stroke-width:1.0;" width="10" x="337.5" y="163.4883"/><rect fill="#AABACF" height="824.75" style="stroke:#393939;stroke-width:1.0;" width="10" x="578.5" y="203.7578"/><rect fill="#F4F2EE" height="180.0781" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="637.5" x="296.5" y="245.3359"/><path d="M296.5,356.4219 L934,356.4219 L934,421.9141 A3.5,3.5 0 0 1 930.5,425.4141 L300,425.4141 A3.5,3.5 0 0 1 296.5,421.9141 L296.5,356.4219 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><rect fill="#F4F2EE" height="474.7813" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="944.5" x="92" y="545.7266"/><rect fill="#F4F2EE" height="83.6328" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="355" x="437" y="625.0391"/><rect fill="#F4F2EE" height="87.3438" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="286.5" x="102" y="857.1719"/><path d="M102,902.1016 L388.5,902.1016 L388.5,941.0156 A3.5,3.5 0 0 1 385,944.5156 L105.5,944.5156 A3.5,3.5 0 0 1 102,941.0156 L102,902.1016 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><path d="M92,951.5156 L1036.5,951.5156 L1036.5,1017.0078 A3.5,3.5 0 0 1 1033,1020.5078 L95.5,1020.5078 A3.5,3.5 0 0 1 92,1017.0078 L92,951.5156 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="127" x2="127" y1="121.2188" y2="1037.5078"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="342.5" x2="342.5" y1="121.2188" y2="1037.5078"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="583" x2="583" y1="121.2188" y2="1037.5078"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="890" x2="890" y1="121.2188" y2="1037.5078"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="112" y="118.1426">Bob</text><ellipse cx="127.5" cy="52.1094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M127.5,60.1094 L127.5,87.1094 M114.5,68.1094 L140.5,68.1094 M127.5,87.1094 L114.5,102.1094 M127.5,87.1094 L140.5,102.1094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="112" y="1051.041">Bob</text><ellipse cx="127.5" cy="1062.6172" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M127.5,1070.6172 L127.5,1097.6172 M114.5,1078.6172 L140.5,1078.6172 M127.5,1097.6172 L114.5,1112.6172 M127.5,1097.6172 L140.5,1112.6172 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="306.5" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="313.5" y="110.1426">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="306.5" y="1036.5078"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="313.5" y="1058.041">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="549" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="556" y="110.1426">Backend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="549" y="1036.5078"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="556" y="1058.041">Backend</text><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="857" y="118.1426">Database</text><path d="M872.5,67.6094 C872.5,57.6094 890.5,57.6094 890.5,57.6094 C890.5,57.6094 908.5,57.6094 908.5,67.6094 L908.5,93.6094 C908.5,103.6094 890.5,103.6094 890.5,103.6094 C890.5,103.6094 872.5,103.6094 872.5,93.6094 L872.5,67.6094 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M872.5,67.6094 C872.5,77.6094 890.5,77.6094 890.5,77.6094 C890.5,77.6094 908.5,77.6094 908.5,67.6094 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="857" y="1051.041">Database</text><path d="M872.5,1064.1172 C872.5,1054.1172 890.5,1054.1172 890.5,1054.1172 C890.5,1054.1172 908.5,1054.1172 908.5,1064.1172 L908.5,1090.1172 C908.5,1100.1172 890.5,1100.1172 890.5,1100.1172 C890.5,1100.1172 872.5,1100.1172 872.5,1090.1172 L872.5,1064.1172 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M872.5,1064.1172 C872.5,1074.1172 890.5,1074.1172 890.5,1074.1172 C890.5,1074.1172 908.5,1074.1172 908.5,1064.1172 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><rect fill="#AABACF" height="865.0195" style="stroke:#393939;stroke-width:1.0;" width="10" x="337.5" y="163.4883"/><rect fill="#AABACF" height="824.75" style="stroke:#393939;stroke-width:1.0;" width="10" x="578.5" y="203.7578"/><polygon fill="#CD5764" points="325.5,159.4883,335.5,163.4883,325.5,167.4883,329.5,163.4883" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="127.5" x2="331.5" y1="163.4883" y2="163.4883"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="128" x="134.5" y="159.291">Accesses the received URL</text><path d="M5,139.7188 L5,175.7188 A3.5,3.5 0 0 0 8.5,179.2188 L119.5,179.2188 A3.5,3.5 0 0 0 123,175.7188 L123,146.2188 L113,136.2188 L8.5,136.2188 A3.5,3.5 0 0 0 5,139.7188 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M113,136.2188 L113,144.4688 A1.75,1.75 0 0 0 114.75,146.2188 L123,146.2188 L113,136.2188 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="11" y="150.5615">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="78" x="11" y="161.8818">&lt;origin&gt;/exchange/</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="97" x="11" y="173.2021">?data=&lt;id&gt;#&lt;key&gt;-&lt;iv&gt;</text><polygon fill="#CD5764" points="566.5,199.7578,576.5,203.7578,566.5,207.7578,570.5,203.7578" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="347.5" x2="572.5" y1="203.7578" y2="203.7578"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="212" x="354.5" y="199.5605">Checks if a secret with the specified ID exists</text><polygon fill="#CD5764" points="878.5,226.3359,888.5,230.3359,878.5,234.3359,882.5,230.3359" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="588.5" x2="884.5" y1="230.3359" y2="230.3359"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="278" x="595.5" y="226.1387">Backend searches for the corresponding ID in the database</text><path d="M300,245.3359 L357.5,245.3359 L357.5,253.6875 L347.5,263.6875 L296.5,263.6875 L296.5,248.8359 A3.5,3.5 0 0 1 300,245.3359 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="180.0781" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="637.5" x="296.5" y="245.3359"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="311.5" y="259.8311">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="372.5" y="258.7549">[ID found]</text><polygon fill="#CD5764" points="599.5,278.2656,589.5,282.2656,599.5,286.2656,595.5,282.2656" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="593.5" x2="889.5" y1="282.2656" y2="282.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="127" x="605.5" y="278.0684">Message that ID was found</text><polygon fill="#CD5764" points="358.5,304.8438,348.5,308.8438,358.5,312.8438,354.5,308.8438" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352.5" x2="577.5" y1="308.8438" y2="308.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="83" x="364.5" y="304.6465">Success message</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="347.5" x2="389.5" y1="335.4219" y2="335.4219"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="389.5" x2="389.5" y1="335.4219" y2="348.4219"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="348.5" x2="389.5" y1="348.4219" y2="348.4219"/><polygon fill="#CD5764" points="358.5,344.4219,348.5,348.4219,358.5,352.4219,354.5,348.4219" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="104" x="354.5" y="331.2246">Enable Reveal Button</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="296.5" x2="934" y1="357.4219" y2="357.4219"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="301.5" y="368.8408">[ID not found]</text><polygon fill="#CD5764" points="599.5,386.8359,589.5,390.8359,599.5,394.8359,595.5,390.8359" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="593.5" x2="889.5" y1="390.8359" y2="390.8359"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="142" x="605.5" y="386.6387">Message that no ID was found</text><polygon fill="#CD5764" points="358.5,413.4141,348.5,417.4141,358.5,421.4141,354.5,417.4141" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352.5" x2="577.5" y1="417.4141" y2="417.4141"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="90" x="364.5" y="413.2168">Not found message</text><polygon fill="#CD5764" points="138.5,446.9922,128.5,450.9922,138.5,454.9922,134.5,450.9922" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="132.5" x2="336.5" y1="450.9922" y2="450.9922"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="76" x="144.5" y="446.7949">Visual feedback</text><polygon fill="#CD5764" points="325.5,473.5703,335.5,477.5703,325.5,481.5703,329.5,477.5703" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="127.5" x2="331.5" y1="477.5703" y2="477.5703"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="186" x="134.5" y="473.373">Clicks on Reveal Button (Success case)</text><polygon fill="#CD5764" points="566.5,500.1484,576.5,504.1484,566.5,508.1484,570.5,504.1484" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="347.5" x2="572.5" y1="504.1484" y2="504.1484"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="158" x="354.5" y="499.9512">Download command for the secret</text><polygon fill="#CD5764" points="878.5,526.7266,888.5,530.7266,878.5,534.7266,882.5,530.7266" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="588.5" x2="884.5" y1="530.7266" y2="530.7266"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="213" x="595.5" y="526.5293">Backend selects the secret from the database</text><path d="M95.5,545.7266 L153,545.7266 L153,554.0781 L143,564.0781 L92,564.0781 L92,549.2266 A3.5,3.5 0 0 1 95.5,545.7266 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="474.7813" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="944.5" x="92" y="545.7266"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="107" y="560.2217">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="168" y="559.1455">[ID found]</text><polygon fill="#CD5764" points="599.5,592.3477,589.5,596.3477,599.5,600.3477,595.5,596.3477" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="593.5" x2="889.5" y1="596.3477" y2="596.3477"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="99" x="605.5" y="592.1504">Delivery of the secret</text><path d="M895,572.5781 L895,608.5781 A3.5,3.5 0 0 0 898.5,612.0781 L1017.5,612.0781 A3.5,3.5 0 0 0 1021,608.5781 L1021,579.0781 L1011,569.0781 L898.5,569.0781 A3.5,3.5 0 0 0 895,572.5781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M1011,569.0781 L1011,577.3281 A1.75,1.75 0 0 0 1012.75,579.0781 L1021,579.0781 L1011,569.0781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="901" y="583.4209">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="89" x="901" y="594.7412">Nonce: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="77" x="901" y="606.0615">Tag: base64 string</text><path d="M440.5,625.0391 L498,625.0391 L498,633.3906 L488,643.3906 L437,643.3906 L437,628.5391 A3.5,3.5 0 0 1 440.5,625.0391 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="83.6328" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="355" x="437" y="625.0391"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="452" y="639.5342">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="513" y="638.458">[Nonce &amp; Tag available]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="588.5" x2="630.5" y1="674.8203" y2="674.8203"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="630.5" x2="630.5" y1="674.8203" y2="687.8203"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="589.5" x2="630.5" y1="687.8203" y2="687.8203"/><polygon fill="#CD5764" points="599.5,683.8203,589.5,687.8203,599.5,691.8203,595.5,687.8203" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="195" x="595.5" y="670.623">Decryption of the second encryption layer</text><path d="M447,651.8906 L447,699.8906 A3.5,3.5 0 0 0 450.5,703.3906 L569.5,703.3906 A3.5,3.5 0 0 0 573,699.8906 L573,658.3906 L563,648.3906 L450.5,648.3906 A3.5,3.5 0 0 0 447,651.8906 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M563,648.3906 L563,656.6406 A1.75,1.75 0 0 0 564.75,658.3906 L573,658.3906 L563,648.3906 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="453" y="662.7334">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="60" x="453" y="674.0537">Key: 32 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="70" x="453" y="685.374">Nonce: 12 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="58" x="453" y="696.6943">Tag: 16 bytes</text><polygon fill="#CD5764" points="878.5,730.25,888.5,734.25,878.5,738.25,882.5,734.25" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="588.5" x2="884.5" y1="734.25" y2="734.25"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="224" x="595.5" y="730.0527">Deletion command of the secret in the database</text><polygon fill="#CD5764" points="358.5,770.5195,348.5,774.5195,358.5,778.5195,354.5,774.5195" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="352.5" x2="577.5" y1="774.5195" y2="774.5195"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="122" x="364.5" y="770.3223">Transmission of the secret</text><path d="M244,750.75 L244,786.75 A3.5,3.5 0 0 0 247.5,790.25 L328.5,790.25 A3.5,3.5 0 0 0 332,786.75 L332,757.25 L322,747.25 L247.5,747.25 A3.5,3.5 0 0 0 244,750.75 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M322,747.25 L322,755.5 A1.75,1.75 0 0 0 323.75,757.25 L332,757.25 L322,747.25 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="250" y="761.5928">UploadId: Guid</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="67" x="250" y="772.9131">Data: ciphertext</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="250" y="784.2334">Hash: SHA256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="347.5" x2="389.5" y1="821.9805" y2="821.9805"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="389.5" x2="389.5" y1="821.9805" y2="834.9805"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="348.5" x2="389.5" y1="834.9805" y2="834.9805"/><polygon fill="#CD5764" points="358.5,830.9805,348.5,834.9805,358.5,838.9805,354.5,834.9805" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="178" x="354.5" y="817.7832">Decryption of the first encryption layer</text><path d="M203,804.7109 L203,840.7109 A3.5,3.5 0 0 0 206.5,844.2109 L328.5,844.2109 A3.5,3.5 0 0 0 332,840.7109 L332,811.2109 L322,801.2109 L206.5,801.2109 A3.5,3.5 0 0 0 203,804.7109 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M322,801.2109 L322,809.4609 A1.75,1.75 0 0 0 323.75,811.2109 L332,811.2109 L322,801.2109 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="108" x="209" y="815.5537">Ciphertext: from Backend</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="101" x="209" y="826.874">Key: from hashtag URL</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="93" x="209" y="838.1943">IV: from hashtag URL</text><path d="M105.5,857.1719 L163,857.1719 L163,865.5234 L153,875.5234 L102,875.5234 L102,860.6719 A3.5,3.5 0 0 1 105.5,857.1719 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="87.3438" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="286.5" x="102" y="857.1719"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="117" y="871.667">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="178" y="870.5908">[Decryption successful]</text><polygon fill="#CD5764" points="138.5,890.1016,128.5,894.1016,138.5,898.1016,134.5,894.1016" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="132.5" x2="336.5" y1="894.1016" y2="894.1016"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="79" x="144.5" y="889.9043">Display plaintext</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="102" x2="388.5" y1="903.1016" y2="903.1016"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="145" x="107" y="914.5205">[Decryption unsuccessful]</text><polygon fill="#CD5764" points="138.5,932.5156,128.5,936.5156,138.5,940.5156,134.5,936.5156" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="132.5" x2="336.5" y1="936.5156" y2="936.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="84" x="144.5" y="932.3184">Display error case</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="92" x2="1036.5" y1="952.5156" y2="952.5156"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="97" y="963.9346">[ID not found]</text><polygon fill="#CD5764" points="599.5,981.9297,589.5,985.9297,599.5,989.9297,595.5,985.9297" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="593.5" x2="889.5" y1="985.9297" y2="985.9297"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="142" x="605.5" y="981.7324">Message that no ID was found</text><polygon fill="#CD5764" points="358.5,1008.5078,348.5,1012.5078,358.5,1016.5078,354.5,1012.5078" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352.5" x2="577.5" y1="1012.5078" y2="1012.5078"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="90" x="364.5" y="1008.3105">Not found message</text><rect fill="#F9F9F9" height="12.5781" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="171" x="437.25" y="1115.1172"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="171" x="437.25" y="1125.498">AnnOtter - Way to Secure Exchange</text><!--MD5=[9b9d751abc1ae9829433b4d623585154]
@startuml

!include theme/annotter-theme.puml

title "Decryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Bob
participant Frontend
participant Backend
database Database

Bob -> Frontend : Accesses the received URL
activate Frontend
note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<iv>
end note

Frontend -> Backend : Checks if a secret with the specified ID exists
activate Backend

Backend -> Database : Backend searches for the corresponding ID in the database

alt ID found
    Database - -> Backend : Message that ID was found
    Backend - -> Frontend : Success message
    Frontend -> Frontend : Enable Reveal Button

else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end

Frontend - -> Bob : Visual feedback

Bob -> Frontend : Clicks on Reveal Button (Success case)

Frontend -> Backend : Download command for the secret

Backend -> Database : Backend selects the secret from the database

alt ID found
    Database - -> Backend : Delivery of the secret
        note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
        end note

    alt Nonce & Tag available
        Backend -> Backend : Decryption of the second encryption layer
        note left
            Ciphertext: base64 string
            Key: 32 bytes
            Nonce: 12 bytes
            Tag: 16 bytes
        end note
    end
        Backend -> Database : Deletion command of the secret in the database

        Backend -> Frontend : Transmission of the secret
        note left
            UploadId: Guid
            Data: ciphertext
            Hash: SHA256
        end note
    
        Frontend -> Frontend: Decryption of the first encryption layer
        note left
            Ciphertext: from Backend
            Key: from hashtag URL
            IV: from hashtag URL
        end note

        alt Decryption successful
            Frontend - -> Bob : Display plaintext
        else Decryption unsuccessful
            Frontend - -> Bob : Display error case
        end
else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end
@enduml

@startuml

skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor cd5764
skinparam FontColor 191919
skinparam ArrowFontSize 10
skinparam ArrowFontStyle italic
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceLifeLineBorderThickness 2
skinparam SequenceLifeLineBackgroundColor aabacf
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1
skinparam SequenceGroupBackgroundColor f4d891
skinparam SequenceGroupBodyBackgroundColor f4f2ee
skinparam SequenceArrowThickness 1
skinparam NoteFontSize 9

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor 4b525b
    BorderColor 191919
    FontColor FFF
    BorderThickness 1
}

skinparam database {
    BackgroundColor 6a7481
    BorderColor FFF
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor C9C9C9
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam alt {
    BackgroundColor f4efe2
}

title "Decryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Bob
participant Frontend
participant Backend
database Database

Bob -> Frontend : Accesses the received URL
activate Frontend
note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<iv>
end note

Frontend -> Backend : Checks if a secret with the specified ID exists
activate Backend

Backend -> Database : Backend searches for the corresponding ID in the database

alt ID found
    Database - -> Backend : Message that ID was found
    Backend - -> Frontend : Success message
    Frontend -> Frontend : Enable Reveal Button

else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end

Frontend - -> Bob : Visual feedback

Bob -> Frontend : Clicks on Reveal Button (Success case)

Frontend -> Backend : Download command for the secret

Backend -> Database : Backend selects the secret from the database

alt ID found
    Database - -> Backend : Delivery of the secret
        note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
        end note

    alt Nonce & Tag available
        Backend -> Backend : Decryption of the second encryption layer
        note left
            Ciphertext: base64 string
            Key: 32 bytes
            Nonce: 12 bytes
            Tag: 16 bytes
        end note
    end
        Backend -> Database : Deletion command of the secret in the database

        Backend -> Frontend : Transmission of the secret
        note left
            UploadId: Guid
            Data: ciphertext
            Hash: SHA256
        end note
    
        Frontend -> Frontend: Decryption of the first encryption layer
        note left
            Ciphertext: from Backend
            Key: from hashtag URL
            IV: from hashtag URL
        end note

        alt Decryption successful
            Frontend - -> Bob : Display plaintext
        else Decryption unsuccessful
            Frontend - -> Bob : Display error case
        end
else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: CH
--></g></svg>