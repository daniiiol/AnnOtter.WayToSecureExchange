<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1147px" preserveAspectRatio="none" style="width:1071px;height:1147px;background:#F9F9F9;" version="1.1" viewBox="0 0 1071 1147" width="1071px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="27.6094" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="147" x="463.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="137" x="468.25" y="29.5332">Decryption Process</text><rect fill="#AABACF" height="876.3398" style="stroke:#393939;stroke-width:1.0;" width="10" x="365.5" y="163.4883"/><rect fill="#AABACF" height="836.0703" style="stroke:#393939;stroke-width:1.0;" width="10" x="606.5" y="203.7578"/><rect fill="#F4F2EE" height="180.0781" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="637.5" x="324.5" y="245.3359"/><path d="M324.5,356.4219 L962,356.4219 L962,421.9141 A3.5,3.5 0 0 1 958.5,425.4141 L328,425.4141 A3.5,3.5 0 0 1 324.5,421.9141 L324.5,356.4219 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><rect fill="#F4F2EE" height="486.1016" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="944.5" x="120" y="545.7266"/><rect fill="#F4F2EE" height="83.6328" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="355" x="465" y="625.0391"/><rect fill="#F4F2EE" height="87.3438" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="286.5" x="130" y="868.4922"/><path d="M130,913.4219 L416.5,913.4219 L416.5,952.3359 A3.5,3.5 0 0 1 413,955.8359 L133.5,955.8359 A3.5,3.5 0 0 1 130,952.3359 L130,913.4219 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><path d="M120,962.8359 L1064.5,962.8359 L1064.5,1028.3281 A3.5,3.5 0 0 1 1061,1031.8281 L123.5,1031.8281 A3.5,3.5 0 0 1 120,1028.3281 L120,962.8359 " fill="#F4F2EE" style="stroke:none;stroke-width:1.0;"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="155" x2="155" y1="121.2188" y2="1048.8281"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="370.5" x2="370.5" y1="121.2188" y2="1048.8281"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="611" x2="611" y1="121.2188" y2="1048.8281"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="918" x2="918" y1="121.2188" y2="1048.8281"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="140" y="118.1426">Bob</text><ellipse cx="155.5" cy="52.1094" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M155.5,60.1094 L155.5,87.1094 M142.5,68.1094 L168.5,68.1094 M155.5,87.1094 L142.5,102.1094 M155.5,87.1094 L168.5,102.1094 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="140" y="1062.3613">Bob</text><ellipse cx="155.5" cy="1073.9375" fill="#C9C9C9" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M155.5,1081.9375 L155.5,1108.9375 M142.5,1089.9375 L168.5,1089.9375 M155.5,1108.9375 L142.5,1123.9375 M155.5,1108.9375 L168.5,1123.9375 " fill="none" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="334.5" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="341.5" y="110.1426">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="72" x="334.5" y="1047.8281"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="341.5" y="1069.3613">Frontend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="577" y="88.6094"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="584" y="110.1426">Backend</text><rect fill="#4B525B" height="31.6094" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.0;" width="69" x="577" y="1047.8281"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="584" y="1069.3613">Backend</text><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="885" y="118.1426">Database</text><path d="M900.5,67.6094 C900.5,57.6094 918.5,57.6094 918.5,57.6094 C918.5,57.6094 936.5,57.6094 936.5,67.6094 L936.5,93.6094 C936.5,103.6094 918.5,103.6094 918.5,103.6094 C918.5,103.6094 900.5,103.6094 900.5,93.6094 L900.5,67.6094 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M900.5,67.6094 C900.5,77.6094 918.5,77.6094 918.5,77.6094 C918.5,77.6094 936.5,77.6094 936.5,67.6094 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="885" y="1062.3613">Database</text><path d="M900.5,1075.4375 C900.5,1065.4375 918.5,1065.4375 918.5,1065.4375 C918.5,1065.4375 936.5,1065.4375 936.5,1075.4375 L936.5,1101.4375 C936.5,1111.4375 918.5,1111.4375 918.5,1111.4375 C918.5,1111.4375 900.5,1111.4375 900.5,1101.4375 L900.5,1075.4375 " fill="#6A7481" style="stroke:#FFFFFF;stroke-width:1.5;"/><path d="M900.5,1075.4375 C900.5,1085.4375 918.5,1085.4375 918.5,1085.4375 C918.5,1085.4375 936.5,1085.4375 936.5,1075.4375 " fill="none" style="stroke:#FFFFFF;stroke-width:1.5;"/><rect fill="#AABACF" height="876.3398" style="stroke:#393939;stroke-width:1.0;" width="10" x="365.5" y="163.4883"/><rect fill="#AABACF" height="836.0703" style="stroke:#393939;stroke-width:1.0;" width="10" x="606.5" y="203.7578"/><polygon fill="#CD5764" points="353.5,159.4883,363.5,163.4883,353.5,167.4883,357.5,163.4883" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="155.5" x2="359.5" y1="163.4883" y2="163.4883"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="128" x="162.5" y="159.291">Accesses the received URL</text><path d="M5,139.7188 L5,175.7188 A3.5,3.5 0 0 0 8.5,179.2188 L147.5,179.2188 A3.5,3.5 0 0 0 151,175.7188 L151,146.2188 L141,136.2188 L8.5,136.2188 A3.5,3.5 0 0 0 5,139.7188 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M141,136.2188 L141,144.4688 A1.75,1.75 0 0 0 142.75,146.2188 L151,146.2188 L141,136.2188 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="33" x="11" y="150.5615">Format:</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="78" x="11" y="161.8818">&lt;origin&gt;/exchange/</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="125" x="11" y="173.2021">?data=&lt;id&gt;#&lt;key&gt;-&lt;salt&gt;-&lt;iv&gt;</text><polygon fill="#CD5764" points="594.5,199.7578,604.5,203.7578,594.5,207.7578,598.5,203.7578" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="375.5" x2="600.5" y1="203.7578" y2="203.7578"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="212" x="382.5" y="199.5605">Checks if a secret with the specified ID exists</text><polygon fill="#CD5764" points="906.5,226.3359,916.5,230.3359,906.5,234.3359,910.5,230.3359" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="616.5" x2="912.5" y1="230.3359" y2="230.3359"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="278" x="623.5" y="226.1387">Backend searches for the corresponding ID in the database</text><path d="M328,245.3359 L385.5,245.3359 L385.5,253.6875 L375.5,263.6875 L324.5,263.6875 L324.5,248.8359 A3.5,3.5 0 0 1 328,245.3359 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="180.0781" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="637.5" x="324.5" y="245.3359"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="339.5" y="259.8311">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="400.5" y="258.7549">[ID found]</text><polygon fill="#CD5764" points="627.5,278.2656,617.5,282.2656,627.5,286.2656,623.5,282.2656" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="621.5" x2="917.5" y1="282.2656" y2="282.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="127" x="633.5" y="278.0684">Message that ID was found</text><polygon fill="#CD5764" points="386.5,304.8438,376.5,308.8438,386.5,312.8438,382.5,308.8438" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="380.5" x2="605.5" y1="308.8438" y2="308.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="83" x="392.5" y="304.6465">Success message</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="375.5" x2="417.5" y1="335.4219" y2="335.4219"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="417.5" x2="417.5" y1="335.4219" y2="348.4219"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="376.5" x2="417.5" y1="348.4219" y2="348.4219"/><polygon fill="#CD5764" points="386.5,344.4219,376.5,348.4219,386.5,352.4219,382.5,348.4219" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="104" x="382.5" y="331.2246">Enable Reveal Button</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="324.5" x2="962" y1="357.4219" y2="357.4219"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="329.5" y="368.8408">[ID not found]</text><polygon fill="#CD5764" points="627.5,386.8359,617.5,390.8359,627.5,394.8359,623.5,390.8359" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="621.5" x2="917.5" y1="390.8359" y2="390.8359"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="142" x="633.5" y="386.6387">Message that no ID was found</text><polygon fill="#CD5764" points="386.5,413.4141,376.5,417.4141,386.5,421.4141,382.5,417.4141" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="380.5" x2="605.5" y1="417.4141" y2="417.4141"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="90" x="392.5" y="413.2168">Not found message</text><polygon fill="#CD5764" points="166.5,446.9922,156.5,450.9922,166.5,454.9922,162.5,450.9922" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="160.5" x2="364.5" y1="450.9922" y2="450.9922"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="76" x="172.5" y="446.7949">Visual feedback</text><polygon fill="#CD5764" points="353.5,473.5703,363.5,477.5703,353.5,481.5703,357.5,477.5703" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="155.5" x2="359.5" y1="477.5703" y2="477.5703"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="186" x="162.5" y="473.373">Clicks on Reveal Button (Success case)</text><polygon fill="#CD5764" points="594.5,500.1484,604.5,504.1484,594.5,508.1484,598.5,504.1484" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="375.5" x2="600.5" y1="504.1484" y2="504.1484"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="158" x="382.5" y="499.9512">Download command for the secret</text><polygon fill="#CD5764" points="906.5,526.7266,916.5,530.7266,906.5,534.7266,910.5,530.7266" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="616.5" x2="912.5" y1="530.7266" y2="530.7266"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="213" x="623.5" y="526.5293">Backend selects the secret from the database</text><path d="M123.5,545.7266 L181,545.7266 L181,554.0781 L171,564.0781 L120,564.0781 L120,549.2266 A3.5,3.5 0 0 1 123.5,545.7266 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="486.1016" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="944.5" x="120" y="545.7266"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="135" y="560.2217">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="196" y="559.1455">[ID found]</text><polygon fill="#CD5764" points="627.5,592.3477,617.5,596.3477,627.5,600.3477,623.5,596.3477" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="621.5" x2="917.5" y1="596.3477" y2="596.3477"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="99" x="633.5" y="592.1504">Delivery of the secret</text><path d="M923,572.5781 L923,608.5781 A3.5,3.5 0 0 0 926.5,612.0781 L1045.5,612.0781 A3.5,3.5 0 0 0 1049,608.5781 L1049,579.0781 L1039,569.0781 L926.5,569.0781 A3.5,3.5 0 0 0 923,572.5781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M1039,569.0781 L1039,577.3281 A1.75,1.75 0 0 0 1040.75,579.0781 L1049,579.0781 L1039,569.0781 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="929" y="583.4209">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="89" x="929" y="594.7412">Nonce: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="77" x="929" y="606.0615">Tag: base64 string</text><path d="M468.5,625.0391 L526,625.0391 L526,633.3906 L516,643.3906 L465,643.3906 L465,628.5391 A3.5,3.5 0 0 1 468.5,625.0391 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="83.6328" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="355" x="465" y="625.0391"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="480" y="639.5342">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="541" y="638.458">[Nonce &amp; Tag available]</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="616.5" x2="658.5" y1="674.8203" y2="674.8203"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="658.5" x2="658.5" y1="674.8203" y2="687.8203"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="617.5" x2="658.5" y1="687.8203" y2="687.8203"/><polygon fill="#CD5764" points="627.5,683.8203,617.5,687.8203,627.5,691.8203,623.5,687.8203" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="195" x="623.5" y="670.623">Decryption of the second encryption layer</text><path d="M475,651.8906 L475,699.8906 A3.5,3.5 0 0 0 478.5,703.3906 L597.5,703.3906 A3.5,3.5 0 0 0 601,699.8906 L601,658.3906 L591,648.3906 L478.5,648.3906 A3.5,3.5 0 0 0 475,651.8906 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M591,648.3906 L591,656.6406 A1.75,1.75 0 0 0 592.75,658.3906 L601,658.3906 L591,648.3906 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="105" x="481" y="662.7334">Ciphertext: base64 string</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="60" x="481" y="674.0537">Key: 32 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="70" x="481" y="685.374">Nonce: 12 bytes</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="58" x="481" y="696.6943">Tag: 16 bytes</text><polygon fill="#CD5764" points="906.5,730.25,916.5,734.25,906.5,738.25,910.5,734.25" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="616.5" x2="912.5" y1="734.25" y2="734.25"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="224" x="623.5" y="730.0527">Deletion command of the secret in the database</text><polygon fill="#CD5764" points="386.5,770.5195,376.5,774.5195,386.5,778.5195,382.5,774.5195" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="380.5" x2="605.5" y1="774.5195" y2="774.5195"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="122" x="392.5" y="770.3223">Transmission of the secret</text><path d="M272,750.75 L272,786.75 A3.5,3.5 0 0 0 275.5,790.25 L356.5,790.25 A3.5,3.5 0 0 0 360,786.75 L360,757.25 L350,747.25 L275.5,747.25 A3.5,3.5 0 0 0 272,750.75 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M350,747.25 L350,755.5 A1.75,1.75 0 0 0 351.75,757.25 L360,757.25 L350,747.25 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="278" y="761.5928">UploadId: Guid</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="67" x="278" y="772.9131">Data: ciphertext</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="62" x="278" y="784.2334">Hash: SHA256</text><line style="stroke:#CD5764;stroke-width:1.0;" x1="375.5" x2="417.5" y1="827.6406" y2="827.6406"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="417.5" x2="417.5" y1="827.6406" y2="840.6406"/><line style="stroke:#CD5764;stroke-width:1.0;" x1="376.5" x2="417.5" y1="840.6406" y2="840.6406"/><polygon fill="#CD5764" points="386.5,836.6406,376.5,840.6406,386.5,844.6406,382.5,840.6406" style="stroke:#CD5764;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="178" x="382.5" y="823.4434">Decryption of the first encryption layer</text><path d="M231,804.7109 L231,852.7109 A3.5,3.5 0 0 0 234.5,856.2109 L356.5,856.2109 A3.5,3.5 0 0 0 360,852.7109 L360,811.2109 L350,801.2109 L234.5,801.2109 A3.5,3.5 0 0 0 231,804.7109 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><path d="M350,801.2109 L350,809.4609 A1.75,1.75 0 0 0 351.75,811.2109 L360,811.2109 L350,801.2109 " fill="#E5E5E5" style="stroke:#181818;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="108" x="237" y="815.5537">Ciphertext: from Backend</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="101" x="237" y="826.874">Key: from hashtag URL</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="93" x="237" y="838.1943">IV: from hashtag URL</text><text fill="#191919" font-family="sans-serif" font-size="9" lengthAdjust="spacing" textLength="100" x="237" y="849.5146">Salt: from hashtag URL</text><path d="M133.5,868.4922 L191,868.4922 L191,876.8438 L181,886.8438 L130,886.8438 L130,871.9922 A3.5,3.5 0 0 1 133.5,868.4922 " fill="#F4D891" style="stroke:#393939;stroke-width:1.5;"/><rect fill="none" height="87.3438" rx="3.5" ry="3.5" style="stroke:#393939;stroke-width:1.0;" width="286.5" x="130" y="868.4922"/><text fill="#191919" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="145" y="882.9873">alt</text><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="206" y="881.9111">[Decryption successful]</text><polygon fill="#CD5764" points="166.5,901.4219,156.5,905.4219,166.5,909.4219,162.5,905.4219" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="160.5" x2="364.5" y1="905.4219" y2="905.4219"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="79" x="172.5" y="901.2246">Display plaintext</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="130" x2="416.5" y1="914.4219" y2="914.4219"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="145" x="135" y="925.8408">[Decryption unsuccessful]</text><polygon fill="#CD5764" points="166.5,943.8359,156.5,947.8359,166.5,951.8359,162.5,947.8359" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="160.5" x2="364.5" y1="947.8359" y2="947.8359"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="84" x="172.5" y="943.6387">Display error case</text><line style="stroke:#393939;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120" x2="1064.5" y1="963.8359" y2="963.8359"/><text fill="#393939" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="125" y="975.2549">[ID not found]</text><polygon fill="#CD5764" points="627.5,993.25,617.5,997.25,627.5,1001.25,623.5,997.25" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="621.5" x2="917.5" y1="997.25" y2="997.25"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="142" x="633.5" y="993.0527">Message that no ID was found</text><polygon fill="#CD5764" points="386.5,1019.8281,376.5,1023.8281,386.5,1027.8281,382.5,1023.8281" style="stroke:#CD5764;stroke-width:1.0;"/><line style="stroke:#CD5764;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="380.5" x2="605.5" y1="1023.8281" y2="1023.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" font-style="italic" lengthAdjust="spacing" textLength="90" x="392.5" y="1019.6309">Not found message</text><rect fill="#F9F9F9" height="12.5781" id="_title" rx="3.5" ry="3.5" style="stroke:none;stroke-width:1.0;" width="171" x="451.25" y="1126.4375"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="171" x="451.25" y="1136.8184">AnnOtter - Way to Secure Exchange</text><!--MD5=[dacdc9c1ba289c235924846a8f3a7c58]
@startuml

!include theme/annotter-theme.puml

title "Decryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Bob
participant Frontend
participant Backend
database Database

Bob -> Frontend : Accesses the received URL
activate Frontend
note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<salt>-<iv>
end note

Frontend -> Backend : Checks if a secret with the specified ID exists
activate Backend

Backend -> Database : Backend searches for the corresponding ID in the database

alt ID found
    Database - -> Backend : Message that ID was found
    Backend - -> Frontend : Success message
    Frontend -> Frontend : Enable Reveal Button

else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end

Frontend - -> Bob : Visual feedback

Bob -> Frontend : Clicks on Reveal Button (Success case)

Frontend -> Backend : Download command for the secret

Backend -> Database : Backend selects the secret from the database

alt ID found
    Database - -> Backend : Delivery of the secret
        note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
        end note

    alt Nonce & Tag available
        Backend -> Backend : Decryption of the second encryption layer
        note left
            Ciphertext: base64 string
            Key: 32 bytes
            Nonce: 12 bytes
            Tag: 16 bytes
        end note
    end
        Backend -> Database : Deletion command of the secret in the database

        Backend -> Frontend : Transmission of the secret
        note left
            UploadId: Guid
            Data: ciphertext
            Hash: SHA256
        end note
    
        Frontend -> Frontend: Decryption of the first encryption layer
        note left
            Ciphertext: from Backend
            Key: from hashtag URL
            IV: from hashtag URL
            Salt: from hashtag URL
        end note

        alt Decryption successful
            Frontend - -> Bob : Display plaintext
        else Decryption unsuccessful
            Frontend - -> Bob : Display error case
        end
else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end
@enduml

@startuml

skinparam BackgroundColor F9F9F9
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor cd5764
skinparam FontColor 191919
skinparam ArrowFontSize 10
skinparam ArrowFontStyle italic
skinparam SequenceLifeLineBorderColor 393939
skinparam SequenceLifeLineBorderThickness 2
skinparam SequenceLifeLineBackgroundColor aabacf
skinparam SequenceGroupHeaderFontColor 191919
skinparam SequenceGroupFontColor 393939
skinparam SequenceGroupBorderColor 393939
skinparam SequenceGroupBorderThickness 1
skinparam SequenceGroupBackgroundColor f4d891
skinparam SequenceGroupBodyBackgroundColor f4f2ee
skinparam SequenceArrowThickness 1
skinparam NoteFontSize 9

skinparam sequenceDivider {
    BorderColor 191919
    BorderThickness 1
    FontColor 191919
}

skinparam participant {
    BackgroundColor 4b525b
    BorderColor 191919
    FontColor FFF
    BorderThickness 1
}

skinparam database {
    BackgroundColor 6a7481
    BorderColor FFF
    FontColor 191919
}

skinparam entity {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam note {
    BackgroundColor e5e5e5
    BorderColor 191919
    FontColor 191919
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor C9C9C9
    BorderColor 191919
    FontColor 191919
}

skinparam boundary {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam control {
    BackgroundColor EFBABC
    BorderColor 191919
    FontColor 191919
}

skinparam collections {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam queue {
    BackgroundColor c9c9c9
    BorderColor 191919
    FontColor 1E1E1E
    BorderThickness 1.5
}

skinparam alt {
    BackgroundColor f4efe2
}

title "Decryption Process"
footer "AnnOtter - Way to Secure Exchange"

actor Bob
participant Frontend
participant Backend
database Database

Bob -> Frontend : Accesses the received URL
activate Frontend
note left
    Format: 
    <origin>/exchange/
    ?data=<id>#<key>-<salt>-<iv>
end note

Frontend -> Backend : Checks if a secret with the specified ID exists
activate Backend

Backend -> Database : Backend searches for the corresponding ID in the database

alt ID found
    Database - -> Backend : Message that ID was found
    Backend - -> Frontend : Success message
    Frontend -> Frontend : Enable Reveal Button

else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end

Frontend - -> Bob : Visual feedback

Bob -> Frontend : Clicks on Reveal Button (Success case)

Frontend -> Backend : Download command for the secret

Backend -> Database : Backend selects the secret from the database

alt ID found
    Database - -> Backend : Delivery of the secret
        note right
            Ciphertext: base64 string
            Nonce: base64 string
            Tag: base64 string
        end note

    alt Nonce & Tag available
        Backend -> Backend : Decryption of the second encryption layer
        note left
            Ciphertext: base64 string
            Key: 32 bytes
            Nonce: 12 bytes
            Tag: 16 bytes
        end note
    end
        Backend -> Database : Deletion command of the secret in the database

        Backend -> Frontend : Transmission of the secret
        note left
            UploadId: Guid
            Data: ciphertext
            Hash: SHA256
        end note
    
        Frontend -> Frontend: Decryption of the first encryption layer
        note left
            Ciphertext: from Backend
            Key: from hashtag URL
            IV: from hashtag URL
            Salt: from hashtag URL
        end note

        alt Decryption successful
            Frontend - -> Bob : Display plaintext
        else Decryption unsuccessful
            Frontend - -> Bob : Display error case
        end
else ID not found
    Database - -> Backend : Message that no ID was found
    Backend - -> Frontend : Not found message
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: CH
--></g></svg>